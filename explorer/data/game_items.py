from math import floor
from typing import Any, Callable, Literal


from ..ctx import Delusion, Delusions, Healable, Rarity, Weapon, state

Weapons: dict[Rarity, dict[int, Callable[..., Weapon]]] = {
    Rarity.Common: {
        1: lambda: Weapon("Icicle", 19, Delusion(Delusions.Freeze), Rarity.Common),
        2: lambda: Weapon("Iron Sword", 24, Delusion(Delusions.Burn), Rarity.Common),
        3: lambda: Weapon("Rose Whip", 11, Delusion(Delusions.Plant), Rarity.Common),
        4: lambda: Weapon("Laser Cannon", 16, Delusion(Delusions.Mech), Rarity.Common),
        5: lambda: Weapon("Dark Gloop", 12, Delusion(Delusions.Corrupt), Rarity.Common),
        6: lambda: Weapon("Slingshot", 20, Delusion(Delusions.Stun), Rarity.Common),
        7: lambda: Weapon("Taser", 18, Delusion(Delusions.Zap), Rarity.Common),
        8: lambda: Weapon("Hungry Spirit", 13, Delusion(Delusions.Drain), Rarity.Common),
        9: lambda: Weapon("Jade Dagger", 23, Delusion(Delusions.Bleed), Rarity.Common),
    },
    Rarity.Rare: {
        1: lambda: Weapon("Frozen Stars", 22, Delusion(Delusions.Freeze), Rarity.Rare),
        2: lambda: Weapon("Fiery Desire", 27, Delusion(Delusions.Burn), Rarity.Rare),
        3: lambda: Weapon("Thorn Lasso", 13, Delusion(Delusions.Plant), Rarity.Rare),
        4: lambda: Weapon("Shield Buster", 17, Delusion(Delusions.Mech), Rarity.Rare),
        5: lambda: Weapon("Symbiotic Arm", 14, Delusion(Delusions.Corrupt), Rarity.Rare),
        6: lambda: Weapon("Rock Pillar", 23, Delusion(Delusions.Stun), Rarity.Rare),
        7: lambda: Weapon("Lightning Rod", 21, Delusion(Delusions.Zap), Rarity.Rare),
        8: lambda: Weapon("Wicked Blade", 18, Delusion(Delusions.Drain), Rarity.Rare),
        9: lambda: Weapon("Amethyst Sword", 25, Delusion(Delusions.Bleed), Rarity.Rare),
    },
    Rarity.Epic: {
        1: lambda: Weapon("Avalanche", 24, Delusion(Delusions.Freeze), Rarity.Epic),
        2: lambda: Weapon("Lava Fist", 29, Delusion(Delusions.Burn), Rarity.Epic),
        3: lambda: Weapon("The Stringless", 16, Delusion(Delusions.Plant), Rarity.Epic),
        4: lambda: Weapon("Fortified Mace", 21, Delusion(Delusions.Mech), Rarity.Epic),
        5: lambda: Weapon("Elusive Eye", 18, Delusion(Delusions.Corrupt), Rarity.Epic),
        6: lambda: Weapon("Judge Club", 25, Delusion(Delusions.Stun), Rarity.Epic),
        7: lambda: Weapon("Electric Glove", 23, Delusion(Delusions.Zap), Rarity.Epic),
        8: lambda: Weapon("Dark Axe", 22, Delusion(Delusions.Drain), Rarity.Epic),
        9: lambda: Weapon("Cruel Claws", 27, Delusion(Delusions.Bleed), Rarity.Epic),
    },
    Rarity.Mythic: {
        1: lambda: Weapon("The Frostbite", 29, Delusion(Delusions.Freeze), Rarity.Mythic),
        2: lambda: Weapon("Hellbringer", 37, Delusion(Delusions.Burn), Rarity.Mythic),
        3: lambda: Weapon("Lustre", 22, Delusion(Delusions.Plant), Rarity.Mythic),
        4: lambda: Weapon("Falcon Turret", 27, Delusion(Delusions.Mech), Rarity.Mythic),
        5: lambda: Weapon("Scimitar", 23, Delusion(Delusions.Corrupt), Rarity.Mythic),
        6: lambda: Weapon("Ancient Club", 30, Delusion(Delusions.Stun), Rarity.Mythic),
        7: lambda: Weapon("Thunder Staff", 27, Delusion(Delusions.Zap), Rarity.Mythic),
        8: lambda: Weapon("Soul Orb", 26, Delusion(Delusions.Drain), Rarity.Mythic),
        9: lambda: Weapon("Divine Wrath", 34, Delusion(Delusions.Bleed), Rarity.Mythic),
    },
}

Heals: dict[int, Callable[..., Healable]] = {
    1: lambda: Healable("Bandage", 15, Rarity.Common),
    2: lambda: Healable("Health Pot", 25, Rarity.Rare),
    3: lambda: Healable("Med Kit", 75, Rarity.Epic),
    4: lambda: Healable("Blessing", 100, Rarity.Mythic),
}

Enemies: dict[tuple[int, int], dict[Literal["atk", "hp", "delusion", "name"], Any]] = {
    (186, 78): {
        "hp": 25,
        "atk": 18,
        "delusion": Delusion(Delusions.Bleed),
        "name": "Crystode",
    },
    (162, 61): {
        "hp": 30,
        "atk": 15,
        "delusion": Delusion(Delusions.Stun),
        "name": "Stone Soldier",
    },
    (194, 90): {
        "hp": 40,
        "atk": 12,
        "delusion": Delusion(Delusions.Plant),
        "name": "Leaf Lurker",
    },
    (212, 92): {
        "hp": 33,
        "atk": 14,
        "delusion": Delusion(Delusions.Drain),
        "name": "Sideways Ghost",
    },
    (220, 70): {
        "hp": 35,
        "atk": 21,
        "delusion": Delusion(Delusions.Stun),
        "name": "Mini Minotaur",
    },
    (238, 81): {
        "hp": 33,
        "atk": 24,
        "delusion": Delusion(Delusions.Mech),
        "name": "Ruin Guard",
    },
    (178, 107): {
        "hp": 32,
        "atk": 14,
        "delusion": Delusion(Delusions.Freeze),
        "name": "Iceberg Turtle",
    },
    (178, 129): {
        "hp": 26,
        "atk": 18,
        "delusion": Delusion(Delusions.Freeze),
        "name": "Mekajiki",
    },
    (193, 131): {
        "hp": 40,
        "atk": 20,
        "delusion": Delusion(Delusions.Zap),
        "name": "Electryx",
    },
    (170, 4): {
        "hp": 21,
        "atk": 15,
        "delusion": Delusion(Delusions.Corrupt),
        "name": "Wavy Shadow",
    },
    (168, 47): {
        "hp": 34,
        "atk": 22,
        "delusion": Delusion(Delusions.Bleed),
        "name": "Fang",
    },
    (168, 49): {
        "hp": 35,
        "atk": 27,
        "delusion": Delusion(Delusions.Burn),
        "name": "Phoenix",
    },
    (168, 51): {
        "hp": 43,
        "atk": 22,
        "delusion": Delusion(Delusions.Mech),
        "name": "West Key Guardian",
    },
    (215, 129): {
        "hp": 30,
        "atk": 19,
        "delusion": Delusion(Delusions.Zap),
        "name": "Baby Thunderbird",
    },
    (217, 109): {
        "hp": 32,
        "atk": 20,
        "delusion": Delusion(Delusions.Drain),
        "name": "Bandit",
    },
    (219, 144): {
        "hp": 28,
        "atk": 19,
        "delusion": Delusion(Delusions.Corrupt),
        "name": "Mirror Knight",
    },
    (225, 117): {
        "hp": 42,
        "atk": 11,
        "delusion": Delusion(Delusions.Plant),
        "name": "Giga Gnome",
    },
    (212, 31): {
        "hp": 40,
        "atk": 10,
        "delusion": Delusion(Delusions.Plant),
        "name": "Eden",
    },
    (214, 4): {
        "hp": 42,
        "atk": 13,
        "delusion": Delusion(Delusions.Plant),
        "name": "Cayenne",
    },
    (220, 6): {
        "hp": 30,
        "atk": 24,
        "delusion": Delusion(Delusions.Burn),
        "name": "Calcifer",
    },
    (222, 25): {
        "hp": 33,
        "atk": 23,
        "delusion": Delusion(Delusions.Bleed),
        "name": "Topaz Tiger",
    },
    (235, 25): {
        "hp": 39,
        "atk": 21,
        "delusion": Delusion(Delusions.Stun),
        "name": "Cavalier",
    },
    (237, 6): {
        "hp": 43,
        "atk": 34,
        "delusion": Delusion(Delusions.Bleed),
        "name": "Mythic Guardian",
    },
    (251, 123): {
        "hp": 35,
        "atk": 20,
        "delusion": Delusion(Delusions.Drain),
        "name": "Life Mage",
    },
    (233, 125): {
        "hp": 37,
        "atk": 19,
        "delusion": Delusion(Delusions.Mech),
        "name": "Iron Ballista",
    },
    (235, 144): {
        "hp": 35,
        "atk": 39,
        "delusion": Delusion(Delusions.Burn),
        "name": "Witch of Flames",
    },
    (241, 133): {
        "hp": 48,
        "atk": 40,
        "delusion": Delusion(Delusions.Corrupt),
        "name": "Dragon of Terror",
    },
    (242, 157): {
        "hp": 29,
        "atk": 23,
        "delusion": Delusion(Delusions.Corrupt),
        "name": "Necromancer",
    },
    (242, 161): {
        "hp": 25,
        "atk": 27,
        "delusion": Delusion(Delusions.Burn),
        "name": "Hellfire Stallion",
    },
    (242, 165): {
        "hp": 32,
        "atk": 22,
        "delusion": Delusion(Delusions.Freeze),
        "name": "Arctic Prisoner",
    },
    (242, 169): {
        "hp": 35,
        "atk": 24,
        "delusion": Delusion(Delusions.Mech),
        "name": "Heavy Sentry",
    },
    (242, 173): {
        "hp": 35,
        "atk": 31,
        "delusion": Delusion(Delusions.Bleed),
        "name": "Executioner",
    },
    (242, 177): {
        "hp": 34,
        "atk": 25,
        "delusion": Delusion(Delusions.Drain),
        "name": "Scoundrel",
    },
}
